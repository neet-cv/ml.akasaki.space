<!doctype html>
<html lang="zh-cn" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-docs docs-doc-id-ch1p2/[5]weight-decay">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">权重衰减 | 工具箱的深度学习记事簿</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ml.akasaki.space/ch1p2/[5]weight-decay"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-docs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs-current"><meta data-rh="true" property="og:title" content="权重衰减 | 工具箱的深度学习记事簿"><meta data-rh="true" name="description" content="上一节中我们观察了过拟合现象，即模型的训练误差远小于它在测试集上的误差。虽然增大训练数据集可能会减轻过拟合，但是获取额外的训练数据往往代价高昂。本节介绍应对过拟合问题的常用方法：权重衰减（weight decay）。"><meta data-rh="true" property="og:description" content="上一节中我们观察了过拟合现象，即模型的训练误差远小于它在测试集上的误差。虽然增大训练数据集可能会减轻过拟合，但是获取额外的训练数据往往代价高昂。本节介绍应对过拟合问题的常用方法：权重衰减（weight decay）。"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://ml.akasaki.space/ch1p2/[5]weight-decay"><link data-rh="true" rel="alternate" href="https://ml.akasaki.space/ch1p2/[5]weight-decay" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://ml.akasaki.space/ch1p2/[5]weight-decay" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="工具箱的深度学习记事簿 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="工具箱的深度学习记事簿 Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.20/dist/katex.min.css" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.3231e09c.css">
<link rel="preload" href="/assets/js/runtime~main.416d7f00.js" as="script">
<link rel="preload" href="/assets/js/main.d42e6425.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">工具箱的深度学习记事簿</b></a><a class="navbar__item navbar__link" href="/blog">魔法部日志</a><a href="https://github.com/neet-cv/ml.akasaki.space" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">Authors &amp; About</a><a href="https://gong.host" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">YetAnotherAkasaki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">首页</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ch0/[1]ai-that-destroying-netizens">第零章：在开始之前</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ch1p1/[1]operate-on-data">第一章上：HelloWorld</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/ch1p2/[1]multilayer-perceptron">第一章下：深度学习基础</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[1]multilayer-perceptron">多层感知机</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[2]multilayer-perceptron-code">多层感知机的代码实现</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[3]activation-functions">激活函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[4]underfit-and-overfit">模型选择、欠拟合和过拟合</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ch1p2/[5]weight-decay">权重衰减</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[6]dropout">丢弃法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[7]forward-and-backprop">正向传播、反向传播和计算图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ch1p2/[8]numerical-stability-and-initializing">数值稳定性、模型初始化、鞍点收敛问题</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ch2p1/[1]convolutional-nn-and-ops">第二章上：卷积神经网络</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ch2p2/[1]LeNet">第二章下：经典卷积神经网络</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ch3p1/[1]deep-learning-for-computer-vision">第三章上：谈一些计算机视觉方向</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ch3p2/[1]bounding-box-and-anchor-box">第三章下：了解更高级的技术</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/appendix-1/[1]similar-vocabularies">附录1：好朋友们</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/appendix-2/[1]bayesian-methods">附录2：数学是真正的圣经</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/appendix-3/[1]about-dsp">附录3：信号和采样的学问（DSP）</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/appendix-4/[1]operation-on-tensors-1">附录4：TensorFlow编程策略</a></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">第一章下：深度学习基础</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">权重衰减</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>权重衰减</h1><p>上一节中我们观察了过拟合现象，即模型的训练误差远小于它在测试集上的误差。虽然增大训练数据集可能会减轻过拟合，但是获取额外的训练数据往往代价高昂。本节介绍应对过拟合问题的常用方法：权重衰减（weight decay）。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="方法">方法<a href="#方法" class="hash-link" aria-label="方法的直接链接" title="方法的直接链接">​</a></h2><p>权重衰减等价于 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 范数正则化（regularization）。正则化通过为模型损失函数添加惩罚项使学出的模型参数值较小，是应对过拟合的常用手段。我们先描述<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数正则化，再解释它为何又称权重衰减。</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数正则化在模型原损失函数基础上添加<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项，从而得到训练所需要最小化的函数。<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项指的是模型权重参数每个元素的平方和与一个正的常数的乘积。以3.1节（线性回归）中的线性回归损失函数</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">ℓ</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo fence="true">(</mo><msubsup><mi>x</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><mi>b</mi><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\ell(w_1, w_2, b) = \frac{1}{n} \sum_{i=1}^n \frac{1}{2}\left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">ℓ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.354em"><span style="top:-3.6029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></div><p>为例，其中<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_1, w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>是权重参数，<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span></span>是偏差参数，样本<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span></span>的输入为<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">x_1^{(i)}, x_2^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3111em;vertical-align:-0.2663em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span></span></span></span></span>，标签为<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">y^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span>，样本数为<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span></span>。将权重参数用向量<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold-italic">w</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{w} = [w_1, w_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em">w</span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>表示，带有<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项的新损失函数为</p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mfrac><mi>λ</mi><mrow><mn>2</mn><mi>n</mi></mrow></mfrac><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">w</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\ell(w_1, w_2, b) + \frac{\lambda}{2n} \|\boldsymbol{w}\|^2,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">ℓ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.2251em;vertical-align:-0.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em">w</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></p><p>其中超参数<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></span>。当权重参数均为0时，惩罚项最小。当<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span></span>较大时，惩罚项在损失函数中的比重较大，这通常会使学到的权重参数的元素较接近0。当<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">λ</span></span></span></span></span>设为0时，惩罚项完全不起作用。上式中<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数平方<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold-italic">w</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\|\boldsymbol{w}\|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord">∥</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.02778em">w</span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>展开后得到<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>w</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>w</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">w_1^2 + w_2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4519em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4519em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span></span></span></span></span>。有了<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项后，在小批量随机梯度下降中，我们将线性回归一节中权重<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>和<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>的迭代方式更改为</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>w</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>η</mi><mi>λ</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">B</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo fence="true">)</mo></mrow><msub><mi>w</mi><mn>1</mn></msub><mo>−</mo><mfrac><mi>η</mi><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">B</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi mathvariant="script">B</mi></mrow></munder><msubsup><mi>x</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mrow><mo fence="true">(</mo><msubsup><mi>x</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><mi>b</mi><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>w</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>←</mo><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>η</mi><mi>λ</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">B</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo fence="true">)</mo></mrow><msub><mi>w</mi><mn>2</mn></msub><mo>−</mo><mfrac><mi>η</mi><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="script">B</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi mathvariant="script">B</mi></mrow></munder><msubsup><mi>x</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><mrow><mo fence="true">(</mo><msubsup><mi>x</mi><mn>1</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup><msub><mi>w</mi><mn>2</mn></msub><mo>+</mo><mi>b</mi><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} w_1 &amp;\leftarrow \left(1- \frac{\eta\lambda}{|\mathcal{B}|} \right)w_1 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_1^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right),\\ w_2 &amp;\leftarrow \left(1- \frac{\eta\lambda}{|\mathcal{B}|} \right)w_2 - \frac{\eta}{|\mathcal{B}|} \sum_{i \in \mathcal{B}}x_2^{(i)} \left(x_1^{(i)} w_1 + x_2^{(i)} w_2 + b - y^{(i)}\right). \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.1434em;vertical-align:-2.8217em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3217em"><span style="top:-5.3217em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8217em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3217em"><span style="top:-5.3217em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.03041em">B</span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mord mathnormal">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.03041em">B</span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.03041em">B</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">(</span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.03041em">B</span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">η</span><span class="mord mathnormal">λ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord mathcal" style="margin-right:0.03041em">B</span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">η</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em"><span style="top:-1.8557em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.03041em">B</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2198em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8217em"><span></span></span></span></span></span></span></span></span></span></span></span></div><p>可见，<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数正则化令权重<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">w_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>和<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">w_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>先自乘小于1的数，再减去不含惩罚项的梯度。因此，<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数正则化又叫权重衰减。权重衰减通过惩罚绝对值较大的模型参数为需要学习的模型增加了限制，这可能对过拟合有效。实际场景中，我们有时也在惩罚项中添加偏差元素的平方和。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="高维线性回归实验">高维线性回归实验<a href="#高维线性回归实验" class="hash-link" aria-label="高维线性回归实验的直接链接" title="高维线性回归实验的直接链接">​</a></h2><p>下面，我们以高维线性回归为例来引入一个过拟合问题，并使用权重衰减来应对过拟合。设数据样本特征的维度为<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span>。对于训练数据集和测试数据集中特征为<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">x_1, x_2, \ldots, x_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span>的任一样本，我们使用如下的线性函数来生成该样本的标签：</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0.05</mn><mo>+</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mn>0.01</mn><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">y = 0.05 + \sum_{i = 1}^p 0.01x_i + \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">0.05</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.9762em;vertical-align:-1.2777em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6985em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3471em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">0.01</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></span></div><p>其中噪声项<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></span>服从均值为0、标准差为0.01的正态分布。为了较容易地观察过拟合，我们考虑高维线性回归问题，如设维度<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">p=200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">200</span></span></span></span></span>；同时，我们特意把训练数据集的样本数设低，如20。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token plain">matplotlib inline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tensorflow </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> layers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> models</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> initializers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimizers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> regularizers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> d2lzh_tensorflow2 </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> d2l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">n_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_inputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true_w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> true_b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ones</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_train </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> n_test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_inputs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">backend</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> true_w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> true_b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labels </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mean</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shape</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">n_train</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">n_train</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_labels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">n_train</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">n_train</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="从零开始实现">从零开始实现<a href="#从零开始实现" class="hash-link" aria-label="从零开始实现的直接链接" title="从零开始实现的直接链接">​</a></h2><p>下面先介绍从零开始实现权重衰减的方法。我们通过在目标函数后添加<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项来实现权重衰减。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="初始化模型参数">初始化模型参数<a href="#初始化模型参数" class="hash-link" aria-label="初始化模型参数的直接链接" title="初始化模型参数的直接链接">​</a></h3><p>首先，定义随机初始化模型参数的函数。该函数为每个参数都附上梯度。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">normal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mean</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_inputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Variable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="定义l_2范数惩罚项">定义<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项<a href="#定义l_2范数惩罚项" class="hash-link" aria-label="定义l_2范数惩罚项的直接链接" title="定义l_2范数惩罚项的直接链接">​</a></h3><p>下面定义<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项。这里只惩罚模型的权重参数。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">l2_penalty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w</span><span class="token operator" style="color:#393A34">**</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="定义训练和测试">定义训练和测试<a href="#定义训练和测试" class="hash-link" aria-label="定义训练和测试的直接链接" title="定义训练和测试的直接链接">​</a></h3><p>下面定义如何在训练数据集和测试数据集上分别训练和测试模型。与前面几节中不同的是，这里在计算最终的损失函数时添加了<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数惩罚项。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_epochs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.003</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> d2l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linreg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> d2l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">squared_loss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">optimizer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SGD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_iter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_tensor_slices</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train_labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shuffle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fit_and_plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lambd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> init_params</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    train_ls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_ls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_epochs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> train_iter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GradientTape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">persistent</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> tape</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># 添加了L2范数惩罚项</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                l </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> lambd </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> l2_penalty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            grads </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tape</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gradient</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">l</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            d2l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sgd</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> grads</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        train_ls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                             train_labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        test_ls</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test_features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            test_labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d2l</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">semilogy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_epochs </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train_ls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;epochs&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_epochs </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_ls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;train&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;L2 norm of w:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">norm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="观察过拟合">观察过拟合<a href="#观察过拟合" class="hash-link" aria-label="观察过拟合的直接链接" title="观察过拟合的直接链接">​</a></h3><p>接下来，让我们训练并测试高维线性回归模型。当<code>lambd</code>设为0时，我们没有使用权重衰减。结果训练误差远小于测试集上的误差。这是典型的过拟合现象。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fit_and_plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lambd</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>输出：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">L2 norm of w: 1.3868197</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="data:image/png;base64,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" width="260" height="181" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用权重衰减">使用权重衰减<a href="#使用权重衰减" class="hash-link" aria-label="使用权重衰减的直接链接" title="使用权重衰减的直接链接">​</a></h3><p>下面我们使用权重衰减。可以看出，训练误差虽然有所提高，但测试集上的误差有所下降。过拟合现象得到一定程度的缓解。另外，权重参数的<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数比不使用权重衰减时的更小，此时的权重参数更接近0。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fit_and_plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lambd</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>输出：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">L2 norm of w: 0.3116793</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="data:image/png;base64,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" width="255" height="181" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="简洁实现">简洁实现<a href="#简洁实现" class="hash-link" aria-label="简洁实现的直接链接" title="简洁实现的直接链接">​</a></h2><p>在 TensorFlow2.0 中，我们可以对<code>Dense</code>层传入 <code>kernel_regularizer</code> 参数进行权重衰减。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fit_and_plot_tf2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">wd</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1e-3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 kernel_regularizer</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">regularizers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">l2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">wd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    bias_regularizer</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">optimizer</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SGD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lr</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">lr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 loss</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">MeanSquaredError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    history </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train_labels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> epochs</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              validation_data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test_features</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             validation_freq</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">verbose</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    train_ls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_ls </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;val_loss&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dl2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">semilogy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_epochs </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train_ls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;epochs&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;loss&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_epochs </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_ls</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;train&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;L2 norm of w:&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">norm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_weights</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">numpy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>与从零开始实现权重衰减的实验现象类似，使用权重衰减可以在一定程度上缓解过拟合问题。</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fit_and_plot_tf2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>输出：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">L2 norm of w: 1.4336505</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="data:image/png;base64,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" width="260" height="181" class="img_ev3q"></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fit_and_plot_tf2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>输出：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">L2 norm of w: 0.26387808</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="data:image/png;base64,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" width="250" height="181" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="小结">小结<a href="#小结" class="hash-link" aria-label="小结的直接链接" title="小结的直接链接">​</a></h2><ul><li>正则化通过为模型损失函数添加惩罚项使学出的模型参数值较小，是应对过拟合的常用手段。</li><li>权重衰减等价于<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>范数正则化，通常会使学到的权重参数的元素较接近0。</li><li>权重衰减可以通过 <code>kernel_regularizer</code>超参数来指定。</li><li>可以定义多个优化器实例对不同的模型参数使用不同的迭代方法。</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/ch1p2/[4]underfit-and-overfit"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">模型选择、欠拟合和过拟合</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ch1p2/[6]dropout"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">丢弃法</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#方法" class="table-of-contents__link toc-highlight">方法</a></li><li><a href="#高维线性回归实验" class="table-of-contents__link toc-highlight">高维线性回归实验</a></li><li><a href="#从零开始实现" class="table-of-contents__link toc-highlight">从零开始实现</a><ul><li><a href="#初始化模型参数" class="table-of-contents__link toc-highlight">初始化模型参数</a></li><li><a href="#定义l_2范数惩罚项" class="table-of-contents__link toc-highlight">定义L_2范数惩罚项</a></li><li><a href="#定义训练和测试" class="table-of-contents__link toc-highlight">定义训练和测试</a></li><li><a href="#观察过拟合" class="table-of-contents__link toc-highlight">观察过拟合</a></li><li><a href="#使用权重衰减" class="table-of-contents__link toc-highlight">使用权重衰减</a></li></ul></li><li><a href="#简洁实现" class="table-of-contents__link toc-highlight">简洁实现</a></li><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">鲁ICP备2021025239号-2 Copyright © 2023 neet-cv.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.416d7f00.js"></script>
<script src="/assets/js/main.d42e6425.js"></script>
</body>
</html>